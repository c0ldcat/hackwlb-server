<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title id="site-title">How to create windows 10 toast notification with PowerShell? | ccat3z's blog</title><link rel="icon" href="/favicon.png"><title>How to create windows 10 toast notification with PowerShell? | ccat3z’s blog</title><meta name="generator" content="Jekyll v3.8.5"><meta property="og:title" content="How to create windows 10 toast notification with PowerShell?"><meta name="author" content="ccat3z"><meta property="og:locale" content="en_US"><meta name="description" content="直接抄…"><meta property="og:description" content="直接抄…"><link rel="canonical" href="//ccat3z.xyz/posts/ps-windows-10-toast-notification/"><meta property="og:url" content="//ccat3z.xyz/posts/ps-windows-10-toast-notification/"><meta property="og:site_name" content="ccat3z’s blog"><meta property="og:type" content="article"><meta property="article:published_time" content="2017-03-17T22:14:50+08:00"><script type="application/ld+json">{"description":"直接抄…","@type":"BlogPosting","url":"//ccat3z.xyz/posts/ps-windows-10-toast-notification/","headline":"How to create windows 10 toast notification with PowerShell?","dateModified":"2017-03-17T22:14:50+08:00","datePublished":"2017-03-17T22:14:50+08:00","mainEntityOfPage":{"@type":"WebPage","@id":"//ccat3z.xyz/posts/ps-windows-10-toast-notification/"},"author":{"@type":"Person","name":"ccat3z"},"@context":"https://schema.org"}</script><link href="https://cdn.bootcss.com/material-design-icons/3.0.1/iconfont/material-icons.css" rel="stylesheet"><link href="https://cdn.jsdelivr.net/npm/vuetify@1.5.9/dist/vuetify.min.css" rel="stylesheet"><link href="/css/blog.dbac4273580ad29f9358.css" rel="stylesheet"></head><body><div id="blog"></div><div id="blog-data"><div id="blog-data-content"><div class="post"><div class="post-info"><a href="/posts/ps-windows-10-toast-notification/" class="post-title">How to create windows 10 toast notification with PowerShell? </a><span class="post-date">17 Mar 2017</span><p class="post-short-description">直接抄…</p><ul class="post-tags"><li><a href="/tag/windows" class="post-tag">Windows</a></li></ul></div><div class="content"><p>直接抄…</p><div class="language-powershell highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ErrorActionPreference</span> <span class="o">=</span> <span class="s2">"Stop"</span>

<span class="nv">$notificationTitle</span> <span class="o">=</span> <span class="s2">"Notification: "</span> + <span class="o">[</span>DateTime]::Now.ToShortTimeString<span class="o">()</span>

<span class="o">[</span>Windows.UI.Notifications.ToastNotificationManager, Windows.UI.Notifications, ContentType <span class="o">=</span> WindowsRuntime] <span class="o">&gt;</span> <span class="nv">$null</span>
<span class="nv">$template</span> <span class="o">=</span> <span class="o">[</span>Windows.UI.Notifications.ToastNotificationManager]::GetTemplateContent<span class="o">([</span>Windows.UI.Notifications.ToastTemplateType]::ToastText01<span class="o">)</span>

<span class="c1">#Convert to .NET type for XML manipuration</span>
<span class="nv">$toastXml</span> <span class="o">=</span> <span class="o">[</span>xml] <span class="nv">$template</span>.GetXml<span class="o">()</span>
<span class="nv">$toastXml</span>.GetElementsByTagName<span class="o">(</span><span class="s2">"text"</span><span class="o">)</span>.AppendChild<span class="o">(</span><span class="nv">$toastXml</span>.CreateTextNode<span class="o">(</span><span class="nv">$notificationTitle</span><span class="o">))</span> <span class="o">&gt;</span> <span class="nv">$null</span>

<span class="c1">#Convert back to WinRT type</span>
<span class="nv">$xml</span> <span class="o">=</span> <span class="nb">New-Object </span>Windows.Data.Xml.Dom.XmlDocument
<span class="nv">$xml</span>.LoadXml<span class="o">(</span><span class="nv">$toastXml</span>.OuterXml<span class="o">)</span>

<span class="nv">$toast</span> <span class="o">=</span> <span class="o">[</span>Windows.UI.Notifications.ToastNotification]::new<span class="o">(</span><span class="nv">$xml</span><span class="o">)</span>
<span class="nv">$toast</span>.Tag <span class="o">=</span> <span class="s2">"PowerShell"</span>
<span class="nv">$toast</span>.Group <span class="o">=</span> <span class="s2">"PowerShell"</span>
<span class="nv">$toast</span>.ExpirationTime <span class="o">=</span> <span class="o">[</span>DateTimeOffset]::Now.AddMinutes<span class="o">(</span>5<span class="o">)</span>
<span class="c1">#$toast.SuppressPopup = $true</span>

<span class="nv">$notifier</span> <span class="o">=</span> <span class="o">[</span>Windows.UI.Notifications.ToastNotificationManager]::CreateToastNotifier<span class="o">(</span><span class="s2">"PowerShell"</span><span class="o">)</span>
<span class="nv">$notifier</span>.Show<span class="o">(</span><span class="nv">$toast</span><span class="o">)</span>;
</code></pre></div></div></div></div></div><div id="blog-data-page-pagination"></div><div id="blog-data-nav"><ul><li><a href="/" class="icon-home">home</a></li><li><a href="/posts/" class="icon-create">post</a></li><li><a href="/projects/" class="icon-code">projects</a></li><li><a href="/tags/" class="icon-bookmark">tags</a></li><li><a href="/love/" class="icon-favorite">love</a></li></ul></div></div><script src="https://cdn.jsdelivr.net/npm/@babel/polyfill@7.4.3/dist/polyfill.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vue@2.6.10/dist/vue.runtime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/vuetify@1.5.9/dist/vuetify.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@1.5.2/velocity.min.js"></script><script src="/js/blog.dbac4273580ad29f9358.js"></script></body></html>